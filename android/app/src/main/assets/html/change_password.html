<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<TITLE>change password</TITLE>
	<link rel="stylesheet" type="text/css" href="css/mint.min.css" />
	<link rel="stylesheet" type="text/css" href="css/common.css" />

	<script src="js/jquery.min-1.11.3.js"></script>
	<script src="js/JSConstants.js"></script>
	<script src="js/JSBridge.js"></script>
	<script src="js/JSBridgeExt.js"></script>
	<script src="js/vue.min.js"></script>
	<script src="js/mint.min.js"></script>

	<style type="text/css">
		body {
			background-color: #fff;
		}

		.mint-header{
			height: 50px;
		}

		.mint-header-title {
			font-size: 25px;
		}

		.mint-cell{
			min-height: 80px;
		}

		.field-btton-container{
			padding: 0 10px;
		}

		.login_title{
			margin-top: 40px;
			padding-left: 10px;
			font-size: 20px;
			font-weight: 600;
		}
	</style>
</HEAD>
<BODY>
<div id="app" class="vue-mint-container">
	<mt-header fixed title="修改密码">
		<mt-button icon="back" slot="left" @click="_goback">返回</mt-button>
	</mt-header>

	<mt-field label="账号" v-model.trim="account"></mt-field>
	<mt-field label="旧密码" v-model.trim="old_password" type="password"></mt-field>
	<mt-field label="新密码" v-model.trim="new_password" type="password"></mt-field>

	<div class="field-btton-container" style="padding-top:20px;">
		<mt-button type="primary" size="large" :disabled="disabled" @click="_save">保存</mt-button>
	</div>
</div>

<script type="text/javascript">
		var vm = new Vue({
			el: '#app',
			data: {
				account: "",
				old_password: "",
				new_password: "",
				disabled: false
			},
			methods: {
				_goback: function(){
					backMainPage();
				},
				_save: function(){
					doSave();
				}
			}
		});

		function pageFinishCallback(){

		}

		function doSave(){
			if(vm.account == ""){
				vm.$toast({
					message: '请输入账号！',
					duration: 1500
				});
				return;
			}

			if(vm.old_password == ""){
				vm.$toast({
					message: '请输入旧密码！',
					duration: 1500
				});
				return;
			}

			if(vm.new_password == ""){
				vm.$toast({
					message: '请输入新密码！',
					duration: 1500
				});
				return;
			}

			vm.disabled = true;
			var obj = {"account":vm.account, "old_password":vm.old_password, "new_password":vm.new_password};
			var msg = jsBridge.dispatchAction("UserAction", JSON.stringify(obj), "changePassword");

			if(msg == "success"){
				vm.$toast({
					message: '密码修改成功！',
					duration: 1500
				});

				setTimeout(function(){backMainPage();}, 1500);

			}else{
				alert(msg);
			}

			vm.disabled = false;
		}
	</script>
</BODY>
</HTML>
