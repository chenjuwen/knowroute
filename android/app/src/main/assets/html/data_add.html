<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<TITLE>data add</TITLE>
	<link rel="stylesheet" type="text/css" href="css/mint.min.css" />
	<link rel="stylesheet" type="text/css" href="css/common.css" />

	<script src="js/jquery.min-1.11.3.js"></script>
	<script src="js/JSConstants.js"></script>
	<script src="js/JSBridge.js"></script>
	<script src="js/JSBridgeExt.js"></script>
	<script src="js/vue.min.js"></script>
	<script src="js/mint.min.js"></script>

	<style type="text/css">
		.mint-checklist-title{
			color: #000;
			font-size: 17px;
		}

		.mint-header{
			height: 50px;
		}
		.mint-header-title {
			font-size: 25px;
		}

		.shengxiao{
			width: 60px;
			margin: 10px 5px;
			position: relative;
			float:left;
		}

		.mint-cell-wrapper{
			background-image:url()
		}

		.mint-cell{
			min-height: 80px;
		}
	</style>
</HEAD>

<BODY>
	<div id="app" class="vue-mint-container">
		<mt-header fixed title="添加数据">
			<mt-button icon="back" slot="left" @click="_goback">返回</mt-button>
		</mt-header>

		<mt-field label="期数:" v-model.trim="period"></mt-field>

		<div style="padding-left:10px;">
			生肖(必须选四个):<br>
			<div v-for="item in options" class="shengxiao">
				{{ item }}
				<input type="checkbox" :value="item" v-model="data"/>
			</div>
		</div>

		<div style="padding:30px 5px 0 5px; clear:left;">
			<mt-button type="primary" size="large" :disabled="disabled" @click="_save">保存</mt-button>
		</div>
	</div>

	<script type="text/javascript">
		var vm = new Vue({
			el: '#app',
			data: {
				options: ['鼠', '牛', '虎', '兔', '龍', '蛇', '馬', '羊', '猴', '鷄', '狗', '猪'],
				period: "",
				disabled: false,
				data: []
			},
			methods: {
				_goback: function(){
					transferPage("data_list.html");
				},

				_save: function(){
					saveData();
				}
			}
		});

		function pageFinishCallback(){

		}

		function saveData(){
			if(vm.period == ""){
				vm.$toast({
					message: '请输入期数！',
					duration: 1500
				});
				return;
			}

			if(vm.data == null || vm.data.length != 4){
				vm.$toast({
					message: '请选择四个生肖，当前选择的生肖为：' + vm.data,
					duration: 1500
				});
				return;
			}

			var dataStr = "";
			for(var i=0; i<vm.data.length; i++){
				if(i > 0){
					dataStr += ",";
				}
				dataStr += vm.data[i];
			}

			vm.disabled = true;

			var obj = {"period":vm.period, "data":dataStr};
			var msg = jsBridge.dispatchAction("DataAction", JSON.stringify(obj), "save");
			
			if(msg == "success"){
				alert("保存成功");
				transferPage("data_list.html");
			}else{
				alert(msg);
			}

			vm.disabled = false;
		}
	</script>

</BODY>
</HTML>
